defmodule PandexTest do
  use ExUnit.Case, async: true
  doctest Pandex

  @min_version_major 2
  @min_version_minor 5

  test "pandoc version >= #{@min_version_major}.#{@min_version_minor}" do
    assert {:ok, [major, minor | _]} = get_pandoc_version()
    assert major >= @min_version_major and minor >= @min_version_minor
  end

  test "markdown_to_html" do
    input = """
    # Title

    ## List
    - one
    - two
    - three
    """

    output = """
    <h1 id="title">Title</h1>
    <h2 id="list">List</h2>
    <ul>
    <li>one</li>
    <li>two</li>
    <li>three</li>
    </ul>
    """

    assert Pandex.markdown_to_html(input) == {:ok, output}
  end

  test "html_to_commonmark" do
    input = """
    <h1 id="title">Title</h1>
    <h2 id="list">List</h2>
    <ul>
      <li>one</li>
      <li>two</li>
      <li>three</li>
    </ul>
    """

    output = """
    # Title

    ## List

    - one
    - two
    - three
    """

    assert Pandex.html_to_commonmark(input) == {:ok, output}
  end

  test "html_to_opendocument" do
    input = """
    <h1 id="title">Title</h1>
    <h2 id="list">List</h2>
    <ul>
    <li>one</li>
    <li>two</li>
    <li>three</li>
    </ul>
    """

    output = """
    <text:h text:style-name="Heading_20_1" text:outline-level="1"><text:bookmark-start text:name="title" />Title<text:bookmark-end text:name="title" /></text:h>
    <text:h text:style-name="Heading_20_2" text:outline-level="2"><text:bookmark-start text:name="list" />List<text:bookmark-end text:name="list" /></text:h>
    <text:list text:style-name="L1">
      <text:list-item>
        <text:p text:style-name="P1">one</text:p>
      </text:list-item>
      <text:list-item>
        <text:p text:style-name="P1">two</text:p>
      </text:list-item>
      <text:list-item>
        <text:p text:style-name="P1">three</text:p>
      </text:list-item>
    </text:list>
    """

    assert Pandex.html_to_opendocument(input) == {:ok, output}
  end

  test "commonmark_to_latex" do
    input = """
    # Title
    ## List
    - one
    - two
    - three
    """

    output = """
    \\section{Title}

    \\subsection{List}

    \\begin{itemize}
    \\tightlist
    \\item
      one
    \\item
      two
    \\item
      three
    \\end{itemize}
    """

    assert Pandex.commonmark_to_latex(input) == {:ok, output}
  end

  test "latex_to_html5" do
    input = """
    \\section{Title}

    \\subsection{List}

    \\begin{itemize}
    \\tightlist
    \\item
      one
    \\item
      two
    \\item
      three
    \\end{itemize}
    """

    output = """
    <h1 id="title">Title</h1>
    <h2 id="list">List</h2>
    <ul>
    <li><p>one</p></li>
    <li><p>two</p></li>
    <li><p>three</p></li>
    </ul>
    """

    assert Pandex.latex_to_html5(input) == {:ok, output}
  end

  test "html_to_latex" do
    input = """
    <h1 id="title">Title</h1>
    <h2 id="list">List</h2>
    <ul>
    <li><p>one</p></li>
    <li><p>two</p></li>
    <li><p>three</p></li>
    </ul>
    """

    output = """
    \\section{Title}\\label{title}

    \\subsection{List}\\label{list}

    \\begin{itemize}
    \\item
      one
    \\item
      two
    \\item
      three
    \\end{itemize}
    """

    assert Pandex.html_to_latex(input) == {:ok, output}
  end

  test "latex_to_json" do
    input = """
    \\section{Title}\\label{title}

    \\subsection{List}\\label{list}

    \\begin{itemize}
    \\item
      one
    \\item
      two
    \\item
      three
    \\end{itemize}
    """

    assert {:ok, api_version} = get_pandoc_api_version()
    api_version = Enum.join(api_version, ",")

    output = """
    {"pandoc-api-version":[#{
      api_version
    }],"meta":{},"blocks":[{"t":"Header","c":[1,["title",[],[]],[{"t":"Str","c":"Title"}]]},{"t":"Header","c":[2,["list",[],[]],[{"t":"Str","c":"List"}]]},{"t":"BulletList","c":[[{"t":"Para","c":[{"t":"Str","c":"one"}]}],[{"t":"Para","c":[{"t":"Str","c":"two"}]}],[{"t":"Para","c":[{"t":"Str","c":"three"}]}]]}]}
    """

    assert Pandex.latex_to_json(input) == {:ok, output}
  end

  test "markdown_to_rst" do
    input = """
    # Title

    ## List
    - one
    - two
    - three
    """

    output = """
    Title
    =====

    List
    ----

    - one
    - two
    - three
    """

    assert Pandex.markdown_to_rst(input) == {:ok, output}
  end

  test "markdown_to_rtf" do
    input = """
    # Title

    ## List
    - one
    - two
    - three
    """

    output = """
    {\\pard \\ql \\f0 \\sa180 \\li0 \\fi0 \\outlinelevel0 \\b \\fs36 Title\\par}
    {\\pard \\ql \\f0 \\sa180 \\li0 \\fi0 \\outlinelevel1 \\b \\fs32 List\\par}
    {\\pard \\ql \\f0 \\sa0 \\li360 \\fi-360 \\bullet \\tx360\\tab one\\par}
    {\\pard \\ql \\f0 \\sa0 \\li360 \\fi-360 \\bullet \\tx360\\tab two\\par}
    {\\pard \\ql \\f0 \\sa0 \\li360 \\fi-360 \\bullet \\tx360\\tab three\\sa180\\par}
    """

    assert Pandex.markdown_to_rtf(input) == {:ok, output}
  end

  test "markdown_to_opendocument" do
    input = """
    # Title

    ## List

    - one
    - two
    - three
    """

    output = """
    <text:h text:style-name="Heading_20_1" text:outline-level="1"><text:bookmark-start text:name="title" />Title<text:bookmark-end text:name="title" /></text:h>
    <text:h text:style-name="Heading_20_2" text:outline-level="2"><text:bookmark-start text:name="list" />List<text:bookmark-end text:name="list" /></text:h>
    <text:list text:style-name="L1">
      <text:list-item>
        <text:p text:style-name="P1">one</text:p>
      </text:list-item>
      <text:list-item>
        <text:p text:style-name="P1">two</text:p>
      </text:list-item>
      <text:list-item>
        <text:p text:style-name="P1">three</text:p>
      </text:list-item>
    </text:list>
    """

    assert Pandex.markdown_to_opendocument(input) == {:ok, output}
  end

  test "commonmark_to_textile" do
    input = """
    # Title

    ## List

    - one
    - two
    - three
    """

    output = """
    h1. Title

    h2. List

    * one
    * two
    * three
    """

    assert Pandex.commonmark_to_textile(input) == {:ok, output}
  end

  test "textile_to_gfm" do
    input = """
    h1. Title

    h2. List

    * one
    * two
    * three
    """

    output = """
    # Title

    ## List

    - one
    - two
    - three
    """

    assert Pandex.textile_to_gfm(input) == {:ok, output}
  end

  test "textile_to_markdown_phpextra" do
    input = """
    h1. Title

    h2. List

    * one
    * two
    * three
    """

    output = """
    # Title {#title}

    ## List {#list}

    - one
    - two
    - three
    """

    assert Pandex.textile_to_markdown_phpextra(input) == {:ok, output}
  end

  test "textile_to_html5" do
    input = """
    h1. Title

    h2. List

    * one
    * two
    * three
    """

    output = """
    <h1 id="title">Title</h1>
    <h2 id="list">List</h2>
    <ul>
    <li>one</li>
    <li>two</li>
    <li>three</li>
    </ul>
    """

    assert Pandex.textile_to_html5(input) == {:ok, output}
  end

  test "textile_to_opendocument" do
    input = """
    h1. Title

    h2. List

    * one
    * two
    * three
    """

    output = """
    <text:h text:style-name="Heading_20_1" text:outline-level="1"><text:bookmark-start text:name="title" />Title<text:bookmark-end text:name="title" /></text:h>
    <text:h text:style-name="Heading_20_2" text:outline-level="2"><text:bookmark-start text:name="list" />List<text:bookmark-end text:name="list" /></text:h>
    <text:list text:style-name="L1">
      <text:list-item>
        <text:p text:style-name="P1">one</text:p>
      </text:list-item>
      <text:list-item>
        <text:p text:style-name="P1">two</text:p>
      </text:list-item>
      <text:list-item>
        <text:p text:style-name="P1">three</text:p>
      </text:list-item>
    </text:list>
    """

    assert Pandex.textile_to_opendocument(input) == {:ok, output}
  end

  test "textile_to_asciidoc" do
    input = """
    h1. Title

    h2. List

    * one
    * two
    * three
    """

    output = """
    == Title

    === List

    * one
    * two
    * three
    """

    assert Pandex.textile_to_asciidoc(input) == {:ok, output}
  end

  test "markdown_to_asciidoc" do
    input = """
    # Title

    ## List

    - one
    - two
    - three
    """

    output = """
    == Title

    === List

    * one
    * two
    * three
    """

    assert Pandex.markdown_to_asciidoc(input) == {:ok, output}
  end

  test "gfm_to_plain" do
    input = """
    # Title

    ## List

    - one
    - two
    - three
    """

    output = """
    Title

    List

    - one
    - two
    - three
    """

    assert Pandex.gfm_to_plain(input) == {:ok, output}
  end

  test "gfm_to_plain with [\"--wrap=none\"] options" do
    input = """
    Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat.
    """

    output = """
    Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod
    tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim
    veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea
    commodo consequat.
    """

    output_wrap_none = input

    assert Pandex.gfm_to_plain(input) == {:ok, output}
    assert Pandex.gfm_to_plain(input, ["--wrap=none"]) == {:ok, output_wrap_none}
  end

  test "markdown_to_docx" do
    input = """
    # Title

    ## List
    - one
    - two
    - three
    """

    output = """
      PK\x03\x04\x14\0\x02\b\b\0\tPuZ\bh\xBA΃\x01\0\0\x8D\a\0\0\x13\0\0\0[Content_Types].xml\xB5\x95\xCBN\xC30\x10E\d%\xCA\x16%nY \x84\xFAX\0]B%\xCA\a\xB8\xF6\xA4\x8D\x88=\x96=\xE9\xE3\xEF\x99$4B\b\x92\x96\xB6\x9BH\xCE̜{}c+\xA3\xE9\xCE\x14\xD1\x06|\xC8ю\xE3a:\x88#\xB0\nunW\xE3\xF8}1K\xEE\xE3\xE9d\xB4\xD8;\b\x11\xB7\xDA0\x8E\xD7D\xEEA\x88\xA0\xD6`dHс\xE5J\x86\xDEH\xE2\xA5_\t'Շ\\\x81\xB8\x1D\f\xEE\x84BK`)\xA1\x8A\x11OFO\x90ɲ\xA0\xE8yǯ\eY\x1E\x8F\xA3Ǧ\xAF\x92\x1A\xC7ҹ\"W\x92\xB8,\xEA\xAA\xF8u\xD0C\x11:&7V\xFF\xB0\x97|YKy\xB2\xEE\t\xEB܅\x9B\x0E\t\xD4D\xD9i\x1A\x98e\xB9\x02\x8D\xAA4<\x92\xE22+\x03w\x83\x9E1\xA4\xD6y\xE5\xC4}\xAE!\x9AKO/\xD20Sl\xD1k\xB1\x85\xE5\e\x10q\xFA!\xEDN\xA5_\xB7\x02:\x8F\nB`\x9E)\xD2o\xF0v\xC7\d:\xB1\xA5Y\x82\xE7\xDE\xCB\xFBh\xD1\xFD.\xC2\xD5\xC2\bG'A|Ρy\x0E\xCF\xF6Qc\xFA53VX\xC8e\x01\x97\xDFx\x8B\xEEt\xC1\xF3s\x8F.\bV;\xDB\x03T\xD7I\x83N؈\x03O9t\xC7ފ+\xF4\xFFH\xE0pǫ\xE9\xD3%\xCB@h\xCE\xDEr\x839V\xBD9\xEB\xB4/\xE0\x1A'\xBD\xE6\xF6뷄\x8B;h+F\xE6\xB6߈BSu_!\x8A\x03\xF9\x98\v\x88d\x91\xAE\xF1=Zt\xEBB\xD4\xFF\xD7\xC9'PK\x03\x04\x14\0\x02\b\b\0\tPuZ\xB7w\xA4\xEF\xE7\0\0\0\xD2\x02\0\0\v\0\0\0_rels/.rels\xAD\x92MN\x031\fF\xAF\x12y\xDF\xF1\x14\nB\xA8i7\xA8Rw\b\x95\x03X\x89g&\xA2\xF9Q\xE2B\xB9=\x01!\xA0\xA8\f]t\x19\xE7\xF3\xF3\x93\xE5\xF9r\xEF\xB7\xEA\x99sq1h\x986-(\x0E&Z\x17z\r\x8F\x9B\xD5\xE4\x06\x96\x8B\xF9\x03oIj\xA2\f.\x15U[B\xD10\x88\xA4[\xC4b\x06\xF6T\x9A\x988ԟ.fOR\x9F\xB9\xC7D\xE6\x89zƋ\xB6\xBD\xC6\xFC\x93\x01\x87L\xB5\xB6\x1A\xF2\xDANAm^\x13\x9F\x8E]\xE7\f\xDFE\xB3\xF3\x1C\xE4Ȉ_\x89J\xA6ܳhx\x89٢\xFD,7\x15\v\n\x8F\xEB\xCCΩ\xC3{\xE1`\xD9NR\xAE\xFDY\x1C\x97o\xA7\xAAs_\xCB\x05)\xA5Q\xA5\xCBӕ\xFE\xDE>z\x16\xB2$\x84&f\x1E\x17zO\x8C\x1A]\x9DsIfW$\xFA\d\x8C>2_Nxp\x9C\x8B7PK\x03\x04\x14\0\x02\b\b\0\tPuZ\x18\xBD}t\xC1\x01\0\0\xAC\x06\0\0\x11\0\0\0word/document.xml\xD5UMo\x9C0\x10\xBD\xEF\xAF@\xBEo\x80=T\x15Z6\x87&Q+\xF5Pu\xD3\x1F\xE0\x9A!X\xB1=Ȟ\x85\xE6\xDF\xD7\x18\f\xA9\xD2]\x91=\xB5\x1Cl\xCF\xC7{~cư\xBF\xFD\xA5Uҁu\x12M\xC9\xF2\x9B\x8C%`\x04V\xD2<\x95\xEC\xC7\xE3\xC3\xF6#\xBB=l\xF6}Q\xA18i0\x94x\x80qE_\xB2\x86\xA8-\xD2ԉ\x064w7؂\xF1\xB1\x1A\xAD\xE6\xE4M\xFB\x94\xF6h\xAB֢\0\xE7<\x9FV\xE9.\xCB>\xA4\x9AK\xC3&\x1A\xBD\x86\x06\xEBZ\n\xB8\x9B\x04D\x12j\"\x89\xBD\x96Ă\xE2\xE4\vw\x8Dl]dÒ\x9D\xAC)&\xAA\xAD\x96¢Ú\xB6\x02u1\xB2LSDt\x97\x10\x9DV1\xAFϳ\x15\xDCáE\x04_SYey\d\xE6x[)\xAE`\xF0(:ٹ\xBC\xBE\xBD\x82\xE3\xCFW\d7\x06Y褟X\xBD\x1C6\x89\d\x82\x81Ϛ\xDB\xE7#qKI_Ȫd\xBB\x9C\xF9\x95\xE1\x1AJF\x92\x94W\x92΀\xF60\f\xDFl\x98\x8E\xF4\xA2\xC0\xE7v\\\x95\xEC3\xF0\xA1m\xF3!{\x9F\xCEIa\bm[\xB8\x96\v\xCF\xD9Zp`;`\x87ǁ}ȥ\x80\xB0#l\x11\xA7\xA4\xA3wi۽C\xDBWO~^\xDA\xF9\xAD>\xA1\xF6TA\x97\x8F\x99\x93\x1E\x93\xA4\xEATLɖ\xE0\x97*:\xF3,\x9B\x8FnB\xAD\x13\x8A\xE6\xC2\x11\xFEC:\xA9\xC7\xFFCgcaESޛ\xEAUK\xA6\x97\xE2\xF9\xEB\xB8\x03A^D0\x83\xA3F$\x83\x04\x8B3I\xE6\xC5\e\xC7X\xE6wpӝ\b\xB5\x02\x17\xCD\x11\xC4r\x19\xFE\xC2\x117L\xDF\xEE8\xF8\x16Y\x835~#\x86U\xFC\xEF\x1C6\xBF\x01PK\x03\x04\x14\0\x02\b\b\0\tPuZu\xAD\xC2f\x04\x01\0\0\xB3\x04\0\0\x1C\0\0\0word/_rels/document.xml.rels\xB5\xD4\xDDN\xC3 \x14\xC0\xF1W!\xE7\xDE\xD2N\x9D\x8B\x19\xDBͲd\xB7Z\x1F\x80\xD2ӏX\xA0\x813uo/\xBAY:\xE3\x857\\6\xFFr\xFA\x83\x90\xAE\xB7\x1Fz`o\xE8|o\x8D\x80\"ˁ\xA1Q\xB6\xEEM+\xE0\xA5\xDC߬`\xBBY?\xE1 )\xBC\xE1\xBB~\xF4,,1^@G4>r\xEEU\x87Z\xFA̎hBi\xACӒ£k\xF9(իl\x91/\xF2|\xC9\xDD|\x06\\\xCFd\xE5i\xC4\xFFL\xB4M\xD3+\xDCYu\xD4h\xE8\x8F\xC1\xDC\x1Cu\x85.\xF0\x81\x1Dj\x01\xEEP\x17\xC0J\xE9Z$\x01S\xCC\xC2\\`<\x99\xC2\xD3i@?\x11\x16\x91p.ɿ\x8FDa\x9BQp;\x13\\Zj\xC3;VϿ\x19w\x911˩%\x8D5T\xCAj\xC0\xC9q\x1F\x1DSL\xAD\xA0\xB06\n\x96Q\xF0\x1DιH\d\x14\x96\x8C\xA5\xD9\xDD|\x98\x1F\xC5%\xA6V(\xAB\xBFRD\xAC\"\xE2\xA7M\x06~\xF5\xF7\xD9|\x02PK\x03\x04\x14\0\x02\b\b\0\tPuZ\x84ٌ#m\0\0\0|\0\0\0\x1D\0\0\0word/_rels/footnotes.xml.relsM\x8CA\x0E\x02!\fE\xAFB\xBAw\x8A.\x8C1\xC3\xCCn\x0E`\xF4\0\rV \x0E\x85Pb<\xBE,]\xFE\xBC\xF7\xFE\xBC~\xF3n>\xDC4\x15qp\x9C,\x18\x16_\x9EI\x82\x83\xC7};\\`]\xE6\e\xEFԇ\xA11U5#\x11u\x10{\xAFWD\xF5\x913\xE9T*\xCB \xAF\xD22\xF51[\xC0J\xFEM\x81\xF1d\xED\x19\xDB\xFF\a\x18\\~PK\x03\x04\x14\0\x02\b\b\0\tPuZ\xC3[\x87x\x1A\x02\0\0R\x10\0\0\x12\0\0\0word/numbering.xml\xC5X[N\xE30\x14\xDDJ\xE4\xFF\xC1q\e\xD2\x12\x11\x10B\xAA\x04\x1A!\xA4\xE9h\xBE\xD3\xC4m-\xF9\x11\xD9I\x03\xBFlf\x96\xC0\xB2\xD8\xC2ء\x81\xA6C\t\xB6H\xDA\x1F+\xF7\xE1\x9E{u\xEC{\x92\xF3\xCB\aF\xBD\r\x96\x8A\b\x1E\x03t\xE2\x03\x0F\xF3Td\x84\xAFb\xF0{>\xFB1\x05\x97\x17\xE7U\xC4K\xB6\xC0R[=\x9D\xC0UT\xC5`]\x14y\x04\xA1Jט%\xEAD\xE4\x98k\xDFRH\x96\x14\xFAQ\xAE`%d\x96K\x91b\xA5t&\xA3p\xE4\xFB!d\t\xE1\xC0\xEC\x99,T!\x93\xB4\xB8+\x99\xD7z\xBA\xC9bpv\xE6\xD7A\\\x91L{7\t\x8D\x81\xAF\dW\xC6\xE1A\xE3b%-\xC8O\xBC\xC1t\xFE\x98\xE3&\xA8\xB6Rc݆\xD1\r\xD5>\xA2\x17\xBD\x03\xD8\x163cE\x93\xB0()\xC5\xC5{\xF0\x1C?\xBC\xF9\xBCw\xF3m\xDA\x18)^6\xE1\xF9\xBD4\v\xE1\x06\xA3\xB1\xC7`2\xD2\xF8\xAAh\x9D\xF0U\xDD\xC4q\xF8\x8A\x17n\xA3a\xBD\xDB>0\xD4?0\x14\x04.\xC8F\xFD#\e\xA1\xD0\x05\xD9x\0dө\v\xB2\xA0\dd\x1A\x88\v\xB2\xD3\xFE\x91\x05c\xA7\x13\x10\xF6\x8F\xEC\xD4w:\x01\x93\x01\x90M\x9CN\xC0\xB4\dda\xF0\xC5\x13\0[W\xF8\x17\xEEwt\xE8~G\xC3\xDD\xEF/O\xCF\xDF\d\xC3W\x91\xDC.3\xC1\vejW)!1\xF8\xF5\xC8\x16\x82ֹW\xBA\xEE]C\xAAZn\xC2\xF5\xFFdx\x99\xE8b\x9B\xBD\xE5\xF7M\x0F\xD1\xC3\xF48X\xF5\xB5(%\xC1һ\xC3\xD5N\xE9{VS\xFF~\xA0e\x13l\a\xD5\xCB\xD3\xDF\x1EF\xD5\xC16\xFC\xD1\xE1FV\xA9\x9D&\xB4l\xA6\x05\xED \xCB\x06\xD8\xCEC'\xF2wN\xC4\xE1\xD9o;m\x1D\xD8\xDF9m\x8F\xCE~\xDB\xC1\xEE\xC4\xFE\xCE\xD1~D\xF6\xDB\xEA\a'\xF6w*\x88\xE1\xD9o\xABN\x1C\xD8ߩN\x8E\xCE~[!\xE4\xC4\xFEN)4(\xFB\xFF\xD7[\xBC\xD6Y\xFCU_!\xAD\xA5\xF6߲oޔV\xF3\x12\r\xEB\xF8\x8F\x92\xD1gɨ\x95\fw>\x0F\\\xFC\x03PK\x03\x04\x14\0\x02\b\b\0\tPuZ\xC6\xCE\xE4\x131\n\0\0\x97j\0\0\x0F\0\0\0word/styles.xml\xED][wۨ\x16~?\xBF\xC2\xCB\xEF\x1D\xDFe\xB9\xAB\xE9,'\xA9W\xB3N\xA7\xE9\xD4n\xFB\x8Cd\x1Ck\"\v\r\xC2Is~\xFD\x01]\x11F\x16\xE8\x92*m\x9B\x87\x066\e\xF6\xE5c\xB3ABy\xF3\xE7\xF7\x83\xDB{\x808p\x90w\xD1\x1F\xFD1\xEC\xF7\xA0g\xA3\xAD\xE3\xDD]\xF4\xBFlV\xAF\xCC\xFE\x9Fo\xDF<\xBE\x0Eȓ\v\x83\x1Em\xED\x05\xAF\xF1E\dO\x88\xFFz0\b\xEC=<\x80\xE0\x0F\xE4C\x8F\xD2v\b\x1F\0\xA1E|7@\xBB\x9Dc\xC3kd\x1F\x0F\xD0#\x83\xF1ph\f0t\x01\xA1#\x05{\xC7\x0F\xFAqo\x8F*\xBD=\"\xBC\xF51\xB2a\x10P\xD1\x0En\xD4\xDF\x018^\xFF\xED\dz=*\xE1\x16\xD9\xD7p\a\x8E.\tXMX\x87?\xE1\xB8.\xAAJ*\x93RT^!\x8F\x04\xBD\xC7\xD7 \xB0\x1DgCE\x80\x17\xFD\x83\xE3!\xFC~\xE9\x05N\x9FR\xEC\x80p՗\xCE6\xAC\x85  \xCB\xC0\x01R\x96=\xFBEB\x19\xE4\xC6\x0E\xFEG\x9B>\0\xF7\xA2?\x9E\x9EҮ\x82b\xAA\v\xBC;J\xB5\xA8,\x17}\x80_\xAD\x97\xBCH\x17}\xE8\xBD\xFA\xB2\xEE'\xFCq)\xED\xE2̀\xB3C\\\xC8Y\x8A\x8E\xE0ˌ\xE7\v\xC6\v|`;\xA1$`G \x05\x06\xF5\x8B0\x8EϏ\x93\xEF\x94\xD5\b~\vU#\x141\xEB\bq\xD4\xF8\xE8\xE8\x11\xDA\xF1\xDC`\xEAl\xE1\xEE\x03\xB2\xEF\xE1vMh\xB3\x8B\xFE0\xAE\xFC{\x15\xA2%\xABXÃ\xF3\xDE\xD9n\xA1\x97\xD5}\xB9\xF9\x84\x1D\x84\x1D\xF2\xC4\xD5y{g\v\xBF\xED\xA1\xF7%\x80۰~\x10\v\x12\x82>j\xC5\xE4\xA3\xF3\x83\xF1\x84\xB57\xB4\xE5G6\xA2˪ȓOE\xF1\x01\x06w\x18\xF8\xFB~jC\x0F\x1C`⃤\xF9 \xA5\xFE\e\xC9\x1C\x8F7\x88\xBB\x16\x06O\x87\xBBDۧ\r\xFCN\x94\ad\f\xBD\x88#\e\xD3\x02T\xCB[\xAFX(\xD7\xF1\xEE\xF9\x1EX\aW{\x80\v\x05\x17q!C\xC5\xC8\f\xCDmA:\xA7a\\\x1C\xE4Pq\xCE\x04\xF61 \xE8\x10\x02B\xF4\xC1\xCA\xC1\x01\xF9\x94\xDAA\xD54![\x8F\xE3+4Pf\xF5\xAC\x89G\xCB\xE7\xE8J~=\xA3\xD4\x15:P\x03\xAA;:m\xAF\xA5\x85\xB6\x13'\x06\xEFCVRwa\xAA\xDB\xC6!.T\xD6,n\xAD\x01\xDF2\xDF\xF0\xF0\x0E{\x17\xB1}t\x92\x18\x914\e\rϛ\x8D.\x9Eۤ\xEDp\xB8\x1C\rW׋\xBE\xBAY\xA3\xA9A\xE5\x82,Χ\x85\xCFG\x06\fp$\x88\x8F\xA7,\x1Cz\x84\xEAt\x04\xEE:\xFEc'\x92\xD84\x86B,\xF3\x91\xB8\n\x16\xAE\x81\xE0\x1F\xE9\x1AȪ\x8B\xD6@F{\x17ם,\x83\\\d\xBC\xCC\xD9\"83DJ\xB6\x04\xCE\xF2xÕC\x06\xE7\xF5\x04\x856-\xD1\tD\xCDU\x8C\x9E\b\x14\x01\x8A\xF1\"\x96\xC6\x14fѳ\xC0\xD3\x01]\x19\xC4~ro\xA6\xBE[\x1F-\xA2\x15@2\x86Bǝ8C'\x84$\xFD+D\x91Q\x93Q\xC4;\x1E\x84L\xCCq\x1F\xDCt,!\x05\xE3Z+Ɓ*\xF8\xC8\xF9:\x8Dr\x91@\xB3\"\x90\x8C\xCDb\x90p\xB4zS>\xEF%\xC5Y\x9F059\xF1ep,\x83JŹ_׃6r\x11f\xB6b-\xAFX\xE1\xA2\xCF\x16\x9Eвa\xE5\xC6ay\xF9\xD2Hw\x19\xB3\x05\xFB\xE92\x10\x96G\xB2GX9z$͛\x8B\x1DeI\xD7=\x84\xFEG\xD6\xC7@\xA8\xFC@S\x82@m1/\xD8T\x16o)u\"\xF05\xDDu)\xDB/j\xFC\xDBz\xE7\x10i\x05\x84E!\xBD\xBC8\xE1\xEA\xD5K\x90\x93n\x9A\xB7\xB1<\xD5\xCDm\x02'\xF9\x93\x82ʹ\xABU\x14P\x86g\xDC7l\xD8}ڞktSӦ\xCFB7q[\xF7\xA1t\xEB~~\"5\xE6\x89\xEC0ı\\\a\x85v~R?\x10\xC91U\xB5\dA'R\x1F\xE4\x97iŃ\x9E\xF7\x10\xB0\xF3ב\xB2^\xFB\x88\xA17j\x14T|ޒ\x88T\x9E\xE6.\xCE\xDBD/˭\x83\xDB\xFC\x89\xD3\xC4\x100\x88\x8E\x84\xED\xB2?dI\xB3*\xAE\d\xE8\xEEJ\x96\x95\x01\x9B\xC5\xCB,/[\xEF\xC1\x96vq\xB9J\x13\xB3\xE1j:7F\xE2$L\xA8\xD33\xD3sZmz\xC6x\x19kCx\xDC6\x84ǚ\x10\x0E\xD2cd\x9E'wf\xDCI\xC0\x8F\xCA\x01?\xFAU\x01?\x19\x17\x03\x9E\xA3U\0\xFCD\e\xF0\x93\xB6\x01?\xF9\r\xF84\xD7\xD0\x05|\e{\xE8\xBA\xE0mn\x9F,\x82w\xAA\r\xDEi\xDB\xE0\x9D\xFE\xB4\xE0\x9D\xE6\xC0k\x96bw\xF2\xDC\xD8u򥫠ydW\xC0\xE8L\e\xA3\xB3\xB61:\xFB\x8D\xD1$Y|\x91\xF1\xB5\x02\n\rm\x14\x1Am\xA3\xD0\xF8iQ\x98\x03\xA1\xB8W9\x05\xE1\xAC\xFB\x81R\xEF\x18\xBD\x02>\xE7\xDA\xF8\x9C\xB7\x8D\xCF\xF9o|F\xC2H_\x9Bx\xEE \xD9:\x02Mm\x04\x9Am#\xD0\xFC\x99\x11x\x1Es\xF3\x97\x19\x13\xAF\xCD\x14\x91\xE39\xFB\xA9\x83ȅ6\"\x17m#r\xF1\xEB\"\xD2\xECj\x14\xAC\x85\xB93\x0F\x8A\xF2'芯 \xBCO\x0E\xF6\x9B|\a!{\xBC\xA0\f\xBC\x17\xF4\xFAQ\xB7\x0F\xC8\xCB\x012\xAE\x04\x90q\v\0\x19׍L\xBF8j\x9A;e.Gͤ\x12j&-\xA0f\xF2\x83PӉ\xA3\x04\x01\x01\xCF\xF2JS\xFE\xA4T\x13\x01\xD3\x16\x100}\xA1\b\xE8Ɓg\xB9\xA7g\x95<=k\xC1ӳ\x17\xEA\xE9\xEE\xF8Ҩ\xE4K\xA3\x05_\x1A/ԗ\x1D8}+w󼒛\xE7-\xB8y\xFEB\xDD\xDC\x11G\x9A\x95\x1Ci\xB6\xE0H\xF3\x85:\xB2\x03'C\xE5n^Tr\xF3\xA2\x057/^\xA8\x9B\x9F\xF7\x88\xEF\xD2E\xF6\xBD\xDE\xDDX\xC6Qv9\xB6\xCA\xDD\xCF\x12\x1Fi\x9C֕]\xA9-~/7\x9AZ\x1E\xF3\xFB\x8E]t\xFD\x10\xDE-\x8Cn\x16\xC2\x1D\xB5\xFA4zu\x06;w\xFB\xA4tz\x1AWj\xF5\x15B\xC4C\x04j\x19>aҿ\x98\xCC[>?t\xC3\xD6WV\\\x1Fv\xA9\xF6J\xF8+\xD2\xF2\xD9,\xD1i\x1C\x16\xDCʗ\aY\xC5P\x1E3g7\xC3{b\x8CV>\x83\xD7\x14{\x03,\xFE\xFE\a\t\x8BR\x19㖅\xA8\t\xE9\xA7ӧ\xEE\xC3\x03b\xB99 \xD0\xF2M\xE8\xDAH\xE0\xED\xF7\xF0\xB0\xED\xF1\xE4쟶\xBB\x82\xAE\xFB\x17\xC8_W$\xC8/ፖD\x8A\x13I\xBB\xD1\xD0\x14[Z\x88\xD0U]\xA5\xCF\x10n\xA5\x9D2\xFF\x89\xB2\xC7u\xDC\xD3\nZ\n\x13\x89O8\xED0\x84\xFAg\xF4\xD8\xCF\eA\xB8\xAE\x99]va*\x8A\"\xAA\x19w \xF1\x8A\xF8u\x93\xC2qB\xEE\xFC\xEAOl\x81\x99ؗ\bo!\x0E\xB2ڼ\xADÎ\xD9\x17Y8D\xA6\x9D\x9F2Sև\xA5\xEBܥX\x8D:\x12\xA5Jň5\x8C-\\1\xA7\xA3s\xDA\xF1\x1C\xF6ٙ\r\xC4\a\xF5\xBBk)[/⫸Te\xFD\xB4\xFD\xA8M\xF1\x9AT\xBD\f\x99WGے\xAAF,]\x81\xAF\x80\xAF%B\xDA^É*\x1FB)[\eǹ\xB5Q\xD5UN3\xAE\n\x17\x02]K\x85L\xBDr{IZ\x9C\xC7t\xBD\xEF\xBC\xDC\x1C\xC0\x9D\xB6.!\x93\xB6.\x95\xBEBsw\xC4\xEA\xB77\x93\xE6\xF5&ù\x0F\xC8D\n\xC1\xAD\xA6`)_\xAFT\xC4\xD3\x06m\xBA??\xFF\x14\x93\xB9\xF4\xFBGM\xEE˅=_\x05]\xBEBl\x01\xE2\x1C\xB4tI\x98\xCAT)\nT瞵\xB2\x0F\by\x01rA\x90>.\xE5\xAB\n\x9Em5\xF5\x04s\rm\x86\xB9\x8Fǃ\x055>\xCE\x10q\xF5\x126\x1D\x83(\xEF\xEF>\xC3\x1D\xC4г\xA1\xB2X\xE9\xFE\x8Ec\xAD\xE9\xAB\a\x88I.g\n\x8E>M\xAAl\xEC\xF8D\xC7\x05\xD9\x19\x17U\x043H\xAB\x1Fpe\x1C5\x95)y\xF2\x12\xBDQ\xB12G\x97וT\xDB\xDC^\xC5\xE7f\xEA\xEB\xDD\xEDU/\xE5)\xD4N\xF6Ό\xFEIФ\xE9-x\x92Xp\x9F\x8D\xA2\x85\xD9\")\x14}C\xEA\xF4}\xAC\x85bj\xF2C\xDFҰ\x12i\x85-\xA6\x95=V\x17(՞\xF4M\x8C\xD9jQ\xF6\xA4\x8Fß\b\xB4\x92\x80\x87\x8Eئ\xC2l\xE9\xFE^\x8Cj!\xA9\x17\xD2\xE8\xE8\xE7\x12\x03aY\xCA/*!\x999\x91\xFEǾ\x9C\xF9\x8D\x8A\x95\xB4D\xBB]\xD8 vs\xA6щBYT8\xAF\xD0\d\xE1\x13\ed\x83\xEEO\x14\xE2HR}$b\xE3Hl+*%\x0E\x8Cϯ\xE7\xC3\xE8{\x01\x89K\x1A\x90\xFE\x1A\x10\xB0\xA1\x1C2\xF1y\x9A\xA6\xFC9\xC1\x17T\xECa\xE3\x82C\xFB+p\xA5b\xA7\x94:BO\x87\x80ڻa\xA1/\xA9(\x1Fe2\xA7\x84Ή\xBCr\x11 2\x91SB\xE7Df\xC9\e\x01\x9ETj\x9EVGp\xD3\x1C6\x8Fi6\xA6T踾\x9E\xA5\xE7\xD4\xD6\r\v\xBC\xF6\xA1\xED\0\xB7Hn\x81\xDC=\xF1\t\xA6\x99\x84T\xF2\x94\xD29\xA1\x93\xB1\x8B\x85?m\xD19%bd\x9Cq\x80ؠ\x8E\n\x96e\x18\xA6ٰ\n7\a\x1Fai\x8C\xC9(\x8D\xAC\xFAf\v\x81\x06\x1D\xD8g\xC9\xE5\x012%iJ\xEFH\xA47(t\xACƗ\xFE\xF8\xAB\xEA\xE1\xC7ԥ\x19\x80ؠ\x01M,0\x1E\x8DG\rk\xB2\xF4\xE8v\xB9P\x8D<\xB5\x1A\x96\x9E\xCD)1n\xBE\x16\xAC`9j\xC7U\xB9\xA5\e#\xA9\x16)\xA1N0j%\x8D_\x1D=\xBB\bF<\xAD\x96\xE0\xC6æW3\x80\x1Dv\xE6.]\xC78Z\x1D\xC1G\x8B\xD1|n7\x9Fd\x12\x8C\\\x9A\x05?\x16\xE4\x99<\xB9\xABۿ[\x1Fb@\x90\x1C\xED\x1C\xAD\x8E\xF9\x8D\xF0_\xD3;\xA9\xA3\xE3\x92\e)\xDE9R\xBDy\xDA\xC2\xC2\xFB\xEE;\x81^P0QsD\r\xD1c\x11k\x8A\xF6\t\xC3\xF8O\x8C\xC8\xE1 \xD2k%d\xF6\x1C4n\xDB%\xA1ɢu$\xD2X\x92#\xD6\x11}\xBE]\fǋ\x86E\xFF\f\xEF\xA8\xDB\xFF\x02\xF8^\xBE\xF0\x88\xF4g\aǍ\x17\xFD9\x9A\x02\xE4\n䎯\xEF\xDF\0\xF6\n\xB6\x1D\x1C\xA9\xE3J,](\xDF}\xA4\x84\x06֜ݮ\x85S\x8Ew\x18\xCB#LJ\xE8\xAA\xE4\xD1\xF9\xB3L\xF4\x8CRyj&\xBF\x05o\xFF\x0FPK\x03\x04\x14\0\x02\b\b\0\tPuZ\xBC\0\x13i\x16\x01\0\0K\x03\0\0\x12\0\0\0word/footnotes.xml\x9D\x92\xC1n\x830\f\x86_\x05\xE5NCw\x98&\x04\xF4R\xF5\x05\xB6=@\x14B\x89D\xE2\xC86d{\xFB\xA5\xB4l]\xD5M\xA8\x17G\x96\xFD\d\xBFl\xA7\xDA}\xB8!\x9B\f\x92\x05_\x8B\xED\xA6\x10\x99\xF1\x1AZ돵x\d;\xE4/b\xD7T\xB1\xEC\0\xD8\x03\eʒ\xC0S\x19k\xD13\x87RJҽq\x8A6\x10\x8CO\xB5\x0E\xD0)N)\x1Ee\x04l\x03\x826D\x89\xE7\x06\xF9T\x14\xCF\xD2)\xEB\xC5\x05\xE3\xD6`\xA0\xEB\xAC6{У3\x9E\x17\b\xF7\v\x04\x1F\x85\xA0\x19\x14\xA7\xC1\xA9\xB7\x81\x16\x1A\xD4bD_^P\xB9\xB3\x1A\x81\xA0\xE3\\\x83+ϔ˳(\xA6\xFF\x14\x93\e\x96\xBE\xB8-V\xB0OK[\x14j\xCDd-\xAA\xF8\xC7z\x83\xD5\x0F\x10\x92\x8AG\xFC\x1E/\x86\a\x18\xBFO\xBF?\x17\xC5\xF5O\xCAbɟ\xC1\xD4B\x83g\xEB\xC7\xF9\x12\xAF&(T\f(Rٶ\xB5(fM8\x05<\x85\xBB͙l*97ȹW\xFE\xB8\xDCu\xA4[\x97|{cC\xAB\xD0W\t5_PK\x03\x04\x14\0\x02\b\b\0\tPuZ\x1Fn\x03\x13\xD9\0\0\0q\x02\0\0\x11\0\0\0word/comments.xml\x9D\xD1\xC1\x8A\xC3 \x10\x06\xE0W\t\xDES\xD3=\x94E\x9A\xF6R\xF6\t\xB6\x0F \xC64BƑ\x19\x13\xF7\xF1\xD7\xD2X\xE8\xA1%\xE4$2\xF3\d8\xE3\xF1\xFC\ac5[b\x87\xBE\x15\xFB]#*\xEB\rv\xCE\xDFZq\xFD\xFD\xA9\xBF\xC5\xF9tL\xCA \x80\xF5\x91\xAB\xDC\xEFY\xA5V\f1\x06%%\x9B\xC1\x82\xE6\x1D\x06\xEBs\xADG\x02\x1D\xF3\x95n2!u\x81\xD0X\xE6\xCC\xC1(\xBF\x9A\xE6 A;/\x16\x06\xD60\xD8\xF7\xCE\xD8\v\x9A\xE9\xFE\x82\x82ġ \xB4\x15!;\xEA\x98\xE7\xE6\xC1\x05.\x1A\xB6b\"\xAF\x16\xAA\x06g\b\x19\xFBX\xE7\r\xA8\x87\xB2\x1C%1\dJ\xCC0\x96\xBE\xB4oV\xD8\xF7\xA5\x95\x84^3YG:\xBDYopf\x83\x90Sq\xA2\xE7x)l0^\xBF\xFE\xF2(\x8AJ\x9E\xFE\x01PK\x03\x04\x14\0\x02\b\b\0\tPuZ\xD8=\xD5\x1A\x1C\x01\0\0G\x02\0\0\x11\0\0\0docProps/core.xml\xA5\x92\xCDn\xC3 \x10\x84_\xC5\xE2n\x03\x8EZE\xC8q\x0E\xADrj\xA5JMժ7\x04\x9B\x04\xC5\xFC\b\xB6u\xF2\xF6%v\xE24Ro\xBD\xB1\xCC\xEC\xC7,\xD0,\x0F\xB6+\xBE!&\xE3݂\xF0\x8A\x91\x02\x9C\xF2ڸ킼\xADW\xE5\x9C,\xDBF\x05\xA1|\x84\x97\xE8\x03D4\x90\x8A\xDC\xE6\x92PaAv\x88AP\x9A\xD4\x0E\xACLUv\xB8,n|\xB4\x12s\x19\xB74H\xB5\x97[\xA05c\xF7\xD4\x02J-Q\xD2\x13\xB0\f\x13\x91\x9C\x91ZM\xC8\xF0\x15\xBB\x01\xA0\x15\x85\x0E,8L\x94W\x9C^\xBD\bѦ?\e\x06\xE5\x97\xD3\x1A<\x06\xF8\xD3z\x11'\xF7!\x99\xC9\xD8\xF7}\xD5\xCF\x06k\xCE\xCF\xE9\xC7\xF3\xD3\xEB0ji\\B\xE9\x14\x90\xB6\xD1J\xA0\xC1\x0Eچ^\x97y\xA5\"H\xF4qܞ\x8A|\x9B{8\xF6>ꔕ\x9B\xEA<\xD1\xE8\x05]\xE4$b\xCC}Q\xDEg\x0F\x8F\xEB\x15ikVߕlV\xD6|͙`L\xF0\xF9\xE7阛\xFE+\xD0\xE6'ݘ\d\x10/\x801\xF1\xEDoh\d\0PK\x03\x04\x14\0\x02\b\b\0\tPuZ\x01dNFd\x01\0\0\xD4\x02\0\0\x10\0\0\0docProps/app.xml\x9DR\xCBN\xC30\x10\xBC\xF7+\xA2܉Ky\xAAr]!\x10\xE2\0\b\xA9)\x9C-{\x93X8\xB6e\e\x04\d\xCFnӆ 8\x91\xD3\xEE\xCC\xCE\xECf\x12\xBE\xFE\xE8m\xF1\x0E1\x19\xEFV\xE5q5/\vp\xCAk\xE3\xDAU\xB9\xADo\x8F.˵\x98\xF1\xA7\xE8\x03\xC4l \x15(piUv9\x87%cIu\xD0\xCBT!\xED\x90i|\xECe\xC66\xB6\xCC7\x8DQp\xE3\xD5[\x0F.\xB3\xC5|~\xCE\xE0#\x83Ӡ\x8F\xC2hX\x0E\x8E\xCB\xF7\xFC_S\xED\x15ݗ\x9E\xEBπ~bV\x14\xFC\xC5G\x9D\xC4\xE5\tgCEئ\x93\x114jE#m\x02ξ\x01\xA2\xEFP\x1D\xADq\xAF麓\xAE\x05}\x18\xFBM\xD0\xF8\xBDq\x90\xC4񂳡\"\xEC*\x84\xE7!K$\xAA9>\x9CM\xB0\xBD\xEC5mC\xEDod\x86Æ\x9F\xE0\xDE\xC9\x1A%3\xC9\x1E\x8C\x8A>\xF9&\x17\xF4.\x059W\x83\xF18B\x12<.J\x95q׋\xC9\xDD&H\x85W\x9DQ\x04\d2$\xA9\xA1\x0F\x96V>RĶ\xD2>\xF7\x9C\x8D(\x8D`:\ePo\xD1\xE4O\x81K\xA7\xED\xCE\xC1gikӃ8G\xE1\xD8\xEC\xE2V\xD2\xC25~\x981\xEE\x11\xF8y\xAE8\xBD8\x9B\x1E\xB9\xA3\x9F\xB0k\xA3\f\x1D~E\xCE&\xDD@\xB6\x94=\xE1T̰\x18\xFF'\xF1\x05PK\x03\x04\x14\0\x02\b\b\0\tPuZ\x1Ay%\x8D\x88\0\0\0\xD4\0\0\0\x13\0\0\0docProps/custom.xml\x9D\xCE\xC1\n\xC20\x10\x04\xD0_\t\xB9\xB7\x89\x1EDJ\xD3^ĳ\x87꽤\x9B6`\xB2!\xBB-\xFA\xF7\xA6\b~\x80\xC7a\x86Ǵ\xFD+<\xC5\x06\x99<F#\x0F\xB5\x96\x02\xA2\xC5\xC9\xC7\xD9\xC8\xFBp\xADβ\xEF\xDA[\xC6\x04\x99=\x90(\xFBHF.̩Q\x8A\xEC\x02a\xA4\xBAԱ4\x0Es\x18\xB9\xC4<+t\xCE[\xB8\xA0]\x03DVG\xADOʮ\xC4\x18\xAA\xF4\xE3\xE4\xD7k6\xFE\x97\x9C\xD0\xEE\xEF\xE81\xBC\xD3\xEE\xA9\xEE\x03PK\x03\x04\x14\0\x02\b\b\0\tPuZ\x9A\xAC\xBD\t\x17\a\0\0j,\0\0\x15\0\0\0word/theme/theme1.xml\xEDZMo\xDB6\x18\xBE\xF7W\x10\xBA\xBB\x96dK\xB6\x8B\xBA\x85?\x9B\xB6I\e4n\x87\x1Ei\x99\xB6\x18S\xA2@\xD2I\x8D\xA2\xC0Оv\x190\xA0\evX\x81\xDDv\x18\x86\x15X\x81\x15\xBB\xEC\xC7\x04h\xB1u?b\x94\x1C;\xA2,\xD3n:\xB4ƚ\x04\b\"\x92\xCF\xC3\xF7}\xF9~\x99\xD6\xD5\xEB\x8F\x02\x02\x8E\x10㘆uúl\x1A\0\x85\x1E\x1D\xE0pT7\xEE\xF7\xBA\x85\xAA\x01\xB8\x80\xE1\0\x12\x1A\xA2\xBA1Eܸ~\xED\xD2UxE\xF8(@@\xC2C~\x05\xD6\r_\x88\xE8J\xB1\xC8=9\f\xF9e\x1A\xA1P\xCE\r)\v\xA0\x90\x8FlT\x1C0x,i\x03R\xB4M\xD3-\x06\x10\x87\x06\ba Y\xEF\x0E\x87\xD8C\xA0\x17S\x1A\xD7.\x010\xE7\xEF\x10\xF9'\x14<\x1EKF=\xC2\x0E\xBCd\xE74Ҙ\xCD'+\x06ck\xFE\x94<\xF3)o\x11\x06\x8E \xA9\er\xFF\x01=\xEE\xA1G\xC2\0\x04r!'ꆙ\xFC\x18\xC5\x05GQ!\x91\x14D\xAC\xA3L\xD1u\x93\x1F\x95.E\x90Hh\xABtl\xD4_\xF0\x99\x1D\xBBZ\xB6\xB2\xD2؊4\x1Ax\xA7\x1A\xFFfwOá\xE7I\x8BZ\xAB),\xC75\xAB\xB6J\x91\x01-ht\x92\xD4*V)\x97fY\x9A\x92F\x9A\x9A۴\xCBy4\xA5%\x9A\xB2Ƭ\xDDZ\xA7\xED\xE4є\x97h\x9C\xD54\r\xD3n\xD6Jy4\xCE\x12\x8D\xBB\x9A\xA6\xDCiT\xECN\x1E\x8D\x9B\xA2\xF1\t\x0E\xC7\x1A\x12\xB7R\xAD\xBA*\x89\x02\x91\x80!%;z\x96\x9A뚕\xB6ʢ\xA2\xE2\x91E\xD8-\x02qHC\xB1&\x12\x03xHYW\xAESv'P\xE0\x10\x88i\x84\x86Г\xB8F$(\am\xCC#\x02\xA7\x06\x88`H\xB9\x1C6m˒aY6\xED\xC5o\xCA\v\x12&\x04S4\x999\x8F\xAF\x9E\x8BE\a\xDCc8\x12u\xE3\x96\xDC\xD0H\xAD}\xF3\xFA\xF5\xC9\xD3W'O\d?y\xF6\xEC\xE4\xE9\xAF`\x17\x8F|\xA1#؁\xE1(M\xF0\xEE\xA7o\xFEy\xF1%\xF8\xFB\xB7\x1F\xDF=\xFFv\r\x90\xA7\x81o\d\xF9\xEA\xED\x1F\dn\xB4\xA1P$\xFE\xEE\xE5\xDBW/\xDF|\xFF\xF5_??\xD7\xE1\x1A\f\xF6Ӹ\x1E\x0E\x10\aw\xD01\xB8G\x03i\x04ݖ\xA8\xCF\xCE\t\xED\xF9\x10\xA7\xA1\x8Dp\xC4a\bc\xB0\x0E\xD6\x11\xBE\x02\xBB3\x85\x04\xEA\0M\xA4\x1E\xC3\x03&\x13\xB3\x16qcr\xA8(u೉\xC0:\xC4m?P\x10{\x94\x92&ez\x03܎\xC5H\xDBn\x12\x8E\xD6\xC8\xC5&i\xC0=\b\x8F\xB4b\xB52\x8EԙD2.\xB1v\x93\x96\x8F\x14U\xF6\x89\xF4*8B!\x12 \x9E\xA3c\x84t\xF8\x87\x18+糇=F9\x1D\n\xF0\x10\x83&\xC4zC\xF6p_\xE4\xA3wp \x0Fz\xAA\x95]\xBA\x94bѽ\a\xA0I\x89v\xC36:R!2h!\xD1n\x82\x88r\n7\xE0D\xC0@\xAF\x15\fH\x1A\xB2\v\x85\xAFU\xE4`\xCA<\xE5ฐ\xCE4B\x84\x82\xCE\0q\xAE\x05\xDFeSE\xA5\xDBP\xA6l\xBDg\xED\x91i\xA0B\x98\xC0c-d\x17R\x9A\x86\xB4\xE9\xB8\xE5\xC3 \xD2\xEB\x85C?\r\xBA\xC9\xC72R اB/\x1FUc8~\x96\a\v\xC3\xF5\x1E\xF5\0#q\xCE\fu_&\xDC|g\x8Cg&L\e\xAB\x88\xAA9dJ\x86\x10i\xB7k\xB0@)8\r\x86\xF5\x9E\x8C\x94P\xDBE\x88\xC0c8@\bܿ\xA9\x05҈\xE6+v˗\xD9r\ai-z\v\xAA!\x13?\x87\x88\xCB.=n\x9Fu.\x83\xB9\x129\ahD׉\xBA7\xCDd\xD6)\f\x03\xC8\xD6\xEEug\xAC\xBAg\xA7\xCFd\x02ц\r\xF1\xC6Ja\xC1,\xCE8k\xE4\xBB\xCB\x03\xF8~\xFB\xEC\xFBP\xF1\xE5\xF8\x99\xAF\t\x9B)\vϝ\x0E$\xF8\xF0C\xC0\xE8\xFC`Y\x01\xDFߢ=HP\xBEs\xF6 \x06\xBB\xDA\xE2#\xB1\x93|l\x1C\xF0\t~\xA2'\x18\xAA\x89&{\x9Cq˻Խ\xC6\x1D-\x0E7\xEDh\xB7\xA2\x93\x95M\xE1\x9B\x1F^|\xC4\xEE\xF5c\xF4\xADk\x13f\xB6[]\v\xC8\xF6\xA8-\xCA\x06\xF8\xFFѢ\xB6\xE1$\xDCG\xB2\x1C_t\xA8\x17\x1D\xEAE\x87\xBAE\x1D\xEAڬtї\xE6\xA2/\xFAҋ\xBE\xF4\xB3\xEEK\xD5\x1Etv_;\xBF\x8B=\xBB\x9E\r\xD6\xDD\xCE\x0E1!\abJ\xD0.W\xDBY.\x13ڠ+g\xCFFg\xE3\t\xDF\xE2\xE28\xF2忊2\xC5\\\xACD\x8E\x18L\x06\x01\xA3\xE2\v,\xFC\x03\x1FFR&\xCB\xC8\xEC0\xE2\x8A,\x8BQ\x10Q.\xFBhC\x9DZ-TvݬK\x9F\x04{tp\xFA\xA5\x82\xA5~\xE5\xA3RBq\xB6\xD0tV/\x94]\xBF\x98-s+\xB9\xAB\x12\x8B\xCC\x05\xCC\xE8U\x8C\x15[\xA9\xAB\x93\xC8\xF7\xDF\xE9\xABSCշ\xB4\x89\xBE\x95\xFCU\xE7\xD7\xD72?\x99µM\x14\xAEZ\x1F\xAE\xF0l$\xE3\xE1\xB1\xDC\xF2\xC3#\x8C\xBFnu\xCA3+\xC8t \x93\xD0 \xF6\xF8Lx\xCD\x03i\xFB\xA2kc'RO\xC9\xDE\xC4\xF8\xB5\xF2\xF6E\x97\xA2\xAF.\x9B\xA8\xFA\xEAҎ/['\xFD\xBA퉯\x9A&j\x14\xD3؛i\\\xA9ne|%\xC55\xA7NƬan\xF1$!8\x96\xF5\xA0\xE4\xC8m<\x18Ս!\x81\xB2\xED\xF7\x82H\xEE\xC7\xE3\xEA\x0E\xC9(\xAC\e\x9E`\xD9\xF8̭\xBB\eUޕ\xB57AG\x8C\x8B6\xE4\xFE\f\x9C\xACʀ\xE3\xA6B \x06\b\x0Ed\xAA[r\xBE\xE4\x1D\x820GMˮ\x98\x9F\x85\x9E5\xF3\xFF{\x9E\xB3\xA7\x1C\x0FG\xC3!\xF2D\xAE\x97\xA7\xA62\e\xCFf\xE4\xFA\xCC~\xB9\x88\x8Fʹt\x10t\"\xCDt\xE0\x0F\x8EA\x9FL\xD8=(\xCFԩX\xF1Y\x0F0\x17\x8B\x83\x1F`\x96\xCA\x1Eg\a\x9E\xA9\xB8\xF9\xF9Uy\v%?\r'\v!\x89|x\xDANjګ\x19\xDDr.\\\xA8\x92u\xA3\x1C\xEDW\x9813\xACzC\d\xD4\xFDx\x1F\x18ދq\xE9TS\x9DC^\x17\x98-Q\x95\xE5\x12\xB5\xA2\xEEl\xF9'\x9C\x94ޚ\x06L\xD1\xDD٬<\xD7\xF2\xCB\xF3\xC6\r\xDD'm\xD5RfѨ\xA1\x98\xA5\xB4\xA1Y6\xEE\xFB\xB6\xF1\xF3RJ\x91\x15\tg\xE3vn\e\xFA\xB4\xBC\x04\x95\xF4oA\xEAn$\x1EXz\xB14.\x04\xFDC\x99\xF6\xDAh\b'D\xF0\xE2\xE9(z$\x18l\xCD_}\x9B\x97\xA2\xD9\xC4\xD9\x1E\xC9#\x980\\7\x1E\x9BN\xA3ܲ\x9DV\xC1\xAC:\x9DB\xB9T6\vU\xA7Q*4\x1C\xA7du\x1C\xCBl7\xED'g\xB70\xC2\x0F,g&P\x17\x06\x98LOߧMƗީ\r\xE6\xD7I\x97=\x1A\x14ir\xA3SL\xC0\xC9;\xB5\x96\xBD\xFA\x9DZ\x80\xA5\x19\x1F\xDB\x1D\xABl7\xECV\xA1ն\xDCB\xD9n\xBB\x85j\xA5\xD4(\xB4l\xB7m7d\xA9s\xBB\x8D'\x068J\x16[\xCDv\xBB\xDBu\xEC\x82ے\xEB\xCAf\xC3)4\x9A\xA5V\xC1\xADv\x9Av\xD7\xEA\x94ۦ\\\\<3\xB4\xB4\xC2\xDC\xC4s\xFB,\xCC}\xEDҿPK\x03\x04\x14\0\x02\b\b\0\tPuZ\x0F\x9F\x17\x02-\x02\0\0(\x05\0\0\x11\0\0\0word/settings.xml\x9DTMo\xDB0\f\xBD\xEFW\x04>/\xB1\x9B\xA4Y\x114\xED\xA1]\xD6C;\x14p\xBA\xBB\"ӱP\xC9\x14(Ş\xFB\xEBG\d(\xDEС\vv\xB2\xF5\xF8\xC8'>Ҿ\xBE\xFDi\xF4\xA4\x02r\n\xCBMt1K\xA2\t\x94\x123U\x1E6\xD1\xCBn;\xBD\x8Ano\xAE\xEB\xB5\x03\xEF\x19s\x13\xE6\x97nm6Q\xE1\xBD]Ǳ\x93\x05\x18\xE1fh\xA1\xE4X\x8Ed\x84\xE7#\x1Db\xCCs%\xE1\x1E\xE5\xD1@\xE9\xE3y\x92\xACb\x0E\x16\xD1P\x047ё\xCA\xF5Paj\x94$t\x98\xFB\xA9D\xB3GȠ\xFF\x95%\xD0\xC2s\x8B\xAEPօjN\x9FS\xAE\x0F=\xAA=\tjB\x13\xAA\fE\xAA\x8F\x9A\xA8\x8C\x0E\xBC\xFA\x1C\xAD\x1A)\xB3\x84\x12\x9Cc\xB3\x8D~/W_$g\xB8\xD6։ڱ\xBD!\x9AI\xBD\xB6@\x92\xBD\xE0\x01'<ญ\x80\xD9C\x966΃\xD9b\xE9]\x8F\xB28\xE6\xA9\x17\x1E8\xEB@\xC2\x18\xC1\x9EK\r\x82o\xC0[`A\xEBn5\x06\xA8Kr\xBE\xD1\xF0,J\xD8v\xADl\x95\xF6@̮\x04\e\x9C$\xC9r\xE0e\xF8\x1D\xFD\x8E\x84|}\xC2\n\x06\xC5\frq\xD4~'\xF6\xA9G\e\xB2\xBE\xCC\xC3=3\x125+~#\x95= \xA97\xBE\xABЩ\x15\x92\xC1\xC0^\xAC\xFE\xC2\xFE\x01\xE4\x95\xFC\x88\xAB\x9Cբ\x19\xABޏ\xC9_\xF9\x93hN-\xFC\x99\x10\n\xFF\x8B.\v\xC1\xBD\xB2\x15\xC3\r\xEEX\x84P\aZ\xE7\xC6\x1D\x1AK<\xEDन\xE0\x99\xA0RP?+\xE9\x8F\x04=Οg\xE6n>M&\xD7q80\xEAy\x03\xA0\x1Dޣ\x18\xFB\x83r\xFA\x92\x86\ehJ\xDB5\x81'am\xED\"\\l\xA2\xE1%:a\xF3\x80\xCDGl\x11\xB0ň-\x03\xB6\x1C\xB1ˀ]\x8E\xD8*`\xAB\x16\xDB\x1FXS\xABC\xD1K\xEE\x0F\xF3\xE1ة\xE5\xA85֐=4\xBC\xA9\xBC`\xAF\x9B\xE8\x1D\xD4\xF2\x8A1^\xFC\x8E\xB7\re\x82^\xBB\xDAm'\xEDa\x1E\xC6\x06R\x19ރ\xC6\xECG\xF7gCP+\xE7S\xB0<)\x8F\xA7\x9D\xFD\xDC\x05\xE3\xF1\xAFw\xF3\vPK\x03\x04\x14\0\x02\b\b\0\tPuZ\x85\x1CTΜ\0\0\0\xC7\0\0\0\x14\0\0\0word/webSettings.xml]\x8E;\x0E\xC20\x10D\xFB\x9C\xC2rOl(\x10\x8A\xF2\x11M\xE8\"\xA4\xC0\x01L\xB2$\x96lo\xE4\xB5\x12\x8E\xCFBAA9\xF3\xF4FS6/\xEF\xC4\n\x91,\x86J\xEEs-\x05\x84\x01G\e\xA6J\xDEo\xED\xEE$\x9B:+\x03\xE9b\x83G\x0F)1!\xC1V\xA0\x82\xDBJ\xCE)-\x85R4\xCC\xE0\r\xE5\xB8@`\xFA\xC4\xE8M\xE2\x18'\xB5a\x1C\x97\x88\x03\x10\xB1\xEC\x9D:h}T\xDE\xD8 \xEBL\x88\xEF\xB8q\x0E\xB7kw\x11\xEAW\x8D\xD8a\xEA\xCD\ng\xEA\xD9s\xD0Z\a\x1F^\xAA\xBF;\xF5\ePK\x03\x04\x14\0\x02\b\b\0\tPuZ>\\`]\xD9\x01\0\0\x14\t\0\0\x12\0\0\0word/fontTable.xml\xED\x94\xCBn\xA30\x14\x86\xF7y\n\xCB\xFB)\x86\x90梐\xAA7v3\x8BQ\xFB\0\x0E\x98`\xC9\x17\xE4\xE3\x84\xE6\xED\xC78$C\x95\x96VD\xAD4\xD2\xC0\x02\xF3\xFF\xC6\xE7\xF0鷗7/R\xA0\x1D3\xC0\xB5JpxE0b*\xD39W\x9B\x04??\xA5?f\x18\x81\xA5*\xA7B+\x96\xE0=\x03|\xB3\x1A-\xEBE\xA1\x95\x05\xE4>W\xB00\t.\xAD\xAD\x16A\0Y\xC9$\x85+]1\xE5\xBCB\eI\xAD{5\x9B@\x17\x05\xCF؃ζ\x92)\eD\x84\\\a\x86\tj]i(y\x05\xB8]\xAD\xFE\xCCj\xB56yet\xC6\0\\\xAFR\x1C֓\x94+\xBC\x1A!\xD46\x88ꅢ\xD2\xF5}[Y\r\xDE\xF1^E\x95\x06\x16:{GE\x82ID\xEE\b!\xB1{\x1E\xEF\x18\a\xA7\xD9YI\r0{\x9AM:^A%\x17\xFB\xA3\x055\a\xE8\xB8\x15\xB7Yy4w\xD4p\xBA\x16\xAC\xE3\x03\xDF8w\vk\x92`\xF7\x03\x84D\xB3)>(aS\xC8_\xE3V\x89N\ni\x95\xF1k%\xF3\xEB\xF8\xD7p\x9E\xB6Jؙ\xE3\v/\x83\x03\x9B\xB70=q\xC9\0\xFDb5\xFA\xAD%U}\xC0\"rM\xC6d\xE2\xA0M\xDCx<\x10\x98\xF1e\x86\x01{lx=\xA6\xE9_`\xF7N\x99\xCE&wg\xC0\xE6\x1F\x03K\a\x01\xF3\xB9B\x0F\x1C*A\xF7\xFF\xF3\xF5\x11\xAE{*׮I\xF4\x93ڲ\x8FV\x13\xAAC\xB8\x9A\x90\r\xA5ui\xB8H\xD4\rW\xEC\0F\xF1I\xF9\x0EZzk83\xCD~\xEC\x835u\x88\xE6>T\x13\x8Fn\x18,\xA9sfޥU\xF0\x17\x96\xF7\xED\xC3\xDB\xF3}\x18\x9F\a\xEB\xCB\xF6a\e\xAC\d.S\x8D򽙢\x82;R}\xA0R\x9F#\dH]\0꒣\xEA\xEDDE\xF1\xF4\xCBN\xF6\xE3\bV\xA3?PK\x01\x02\0\0\x14\0\x02\b\b\0\tPuZ\bh\xBA΃\x01\0\0\x8D\a\0\0\x13\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0[Content_Types].xmlPK\x01\x02\0\0\x14\0\x02\b\b\0\tPuZ\xB7w\xA4\xEF\xE7\0\0\0\xD2\x02\0\0\v\0\0\0\0\0\0\0\0\0\0\0\0\0\xB4\x01\0\0_rels/.relsPK\x01\x02\0\0\x14\0\x02\b\b\0\tPuZ\x18\xBD}t\xC1\x01\0\0\xAC\x06\0\0\x11\0\0\0\0\0\0\0\0\0\0\0\0\0\xC4\x02\0\0word/document.xmlPK\x01\x02\0\0\x14\0\x02\b\b\0\tPuZu\xAD\xC2f\x04\x01\0\0\xB3\x04\0\0\x1C\0\0\0\0\0\0\0\0\0\0\0\0\0\xB4\x04\0\0word/_rels/document.xml.relsPK\x01\x02\0\0\x14\0\x02\b\b\0\tPuZ\x84ٌ#m\0\0\0|\0\0\0\x1D\0\0\0\0\0\0\0\0\0\0\0\0\0\xF2\x05\0\0word/_rels/footnotes.xml.relsPK\x01\x02\0\0\x14\0\x02\b\b\0\tPuZ\xC3[\x87x\x1A\x02\0\0R\x10\0\0\x12\0\0\0\0\0\0\0\0\0\0\0\0\0\x9A\x06\0\0word/numbering.xmlPK\x01\x02\0\0\x14\0\x02\b\b\0\tPuZ\xC6\xCE\xE4\x131\n\0\0\x97j\0\0\x0F\0\0\0\0\0\0\0\0\0\0\0\0\0\xE4\b\0\0word/styles.xmlPK\x01\x02\0\0\x14\0\x02\b\b\0\tPuZ\xBC\0\x13i\x16\x01\0\0K\x03\0\0\x12\0\0\0\0\0\0\0\0\0\0\0\0\0B\x13\0\0word/footnotes.xmlPK\x01\x02\0\0\x14\0\x02\b\b\0\tPuZ\x1Fn\x03\x13\xD9\0\0\0q\x02\0\0\x11\0\0\0\0\0\0\0\0\0\0\0\0\0\x88\x14\0\0word/comments.xmlPK\x01\x02\0\0\x14\0\x02\b\b\0\tPuZ\xD8=\xD5\x1A\x1C\x01\0\0G\x02\0\0\x11\0\0\0\0\0\0\0\0\0\0\0\0\0\x90\x15\0\0docProps/core.xmlPK\x01\x02\0\0\x14\0\x02\b\b\0\tPuZ\x01dNFd\x01\0\0\xD4\x02\0\0\x10\0\0\0\0\0\0\0\0\0\0\0\0\0\xDB\x16\0\0docProps/app.xmlPK\x01\x02\0\0\x14\0\x02\b\b\0\tPuZ\x1Ay%\x8D\x88\0\0\0\xD4\0\0\0\x13\0\0\0\0\0\0\0\0\0\0\0\0\0m\x18\0\0docProps/custom.xmlPK\x01\x02\0\0\x14\0\x02\b\b\0\tPuZ\x9A\xAC\xBD\t\x17\a\0\0j,\0\0\x15\0\0\0\0\0\0\0\0\0\0\0\0\0&\x19\0\0word/theme/theme1.xmlPK\x01\x02\0\0\x14\0\x02\b\b\0\tPuZ\x0F\x9F\x17\x02-\x02\0\0(\x05\0\0\x11\0\0\0\0\0\0\0\0\0\0\0\0\0p \0\0word/settings.xmlPK\x01\x02\0\0\x14\0\x02\b\b\0\tPuZ\x85\x1CTΜ\0\0\0\xC7\0\0\0\x14\0\0\0\0\0\0\0\0\0\0\0\0\0\xCC\"\0\0word/webSettings.xmlPK\x01\x02\0\0\x14\0\x02\b\b\0\tPuZ>\\`]\xD9\x01\0\0\x14\t\0\0\x12\0\0\0\0\0\0\0\0\0\0\0\0\0\x9A#\0\0word/fontTable.xmlPK\x05\x06\0\0\0\0\x10\0\x10\0\f\x04\0\0\xA3%\0\0\0\0
    """

    assert Pandex.markdown_to_docx(input) == {:ok, output}
  end

  # Private

  defp get_pandoc_version() do
    get_version(~r/^pandoc\s*(?<version>[0-9][0-9.]*)(\r\n|\r|\n)/)
  end

  defp get_pandoc_api_version() do
    # apparently pandoc doesn't list this version anymore in the --version command
    {:ok, [1,23,1]}
  end

  # return version list, e.g. [2, 5]
  defp get_version(regex) do
    with {result, 0} <- System.cmd("pandoc", ["--version"]),
         %{"version" => version} <- Regex.named_captures(regex, result),
         [_, _ | _] = version <- parse_version(version) do
      {:ok, version}
    else
      _ -> :error
    end
  end

  # parse version string into list of integers, e.g. "2.5" returns [2, 5]
  defp parse_version(version) when is_binary(version) do
    version
    |> String.split(".")
    |> Enum.map(&Integer.parse/1)
    |> Enum.map(fn {n, _} -> n end)
  end

  defp parse_version(_), do: :error
end
